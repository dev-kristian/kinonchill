<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Push Notification Test</title>
    <link rel="manifest" href="/manifest.json">
</head>
<body>
    <h1>Push Notification Test</h1>
    <button id="subscribe">Subscribe to Notifications</button>
    <p id="status"></p>
    <script src="https://www.gstatic.com/firebasejs/9.0.0/firebase-app-compat.js"></script>
    <script src="https://www.gstatic.com/firebasejs/9.0.0/firebase-messaging-compat.js"></script>
    <script>
        const firebaseConfig = {
            apiKey: "AIzaSyBMl2-dsWYFs_vVG_oKjBg6WCjl79QBR_Y",
  authDomain: "kino-n-chill.firebaseapp.com",
  projectId: "kino-n-chill",
  storageBucket: "kino-n-chill.appspot.com",
  messagingSenderId: "904976281790",
  appId: "1:904976281790:web:eb2fbdd47862df668a6eef"
        };

        firebase.initializeApp(firebaseConfig);
        const messaging = firebase.messaging();

        function updateStatus(message) {
            document.getElementById('status').textContent = message;
        }

        document.getElementById('subscribe').addEventListener('click', async () => {
            try {
                if (!('Notification' in window)) {
                    updateStatus('This browser does not support notifications. Make sure you\'ve added this page to your home screen and are opening it from there.');
                    return;
                }

                const permission = await Notification.requestPermission();
                if (permission === 'granted') {
                    const token = await messaging.getToken({vapidKey: 'BJC0wYVWUsbg8JRK1joo1xLyDLxE0UdJZcbHNlqnSB-0c_-CCmmfiM_vPdc6kkzs9ytUXaBx-mVcatBQYgaPjZk'});
                    console.log('FCM Token:', token);
                    updateStatus('Subscribed successfully! Token: ' + token);
                } else {
                    console.log('Permission denied');
                    updateStatus('Permission denied');
                }
            } catch (error) {
                console.error('Error:', error);
                updateStatus('Error: ' + error.message);
            }
        });

        messaging.onMessage((payload) => {
            console.log('Message received. ', payload);
            updateStatus('New message: ' + payload.notification.title);
        });
    </script>
</body>
</html>